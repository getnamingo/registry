{% extends "layouts/app.twig" %}

{% block title %}{{ __('Registrar Details') }}{% endblock %}

{% block content %}
      <div class="page-wrapper">
        <!-- Page header -->
        <div class="page-header d-print-none">
          <div class="container-xl">
            <div class="row g-2 align-items-center">
              <div class="col">
                <div class="mb-1">
                  <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                      <a href="{{route('home')}}"><svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><polyline points="5 12 3 12 12 3 21 12 19 12" /><path d="M5 12v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8" /><rect x="10" y="12" width="4" height="4" /></svg></a>
                    </li>
                    <li class="breadcrumb-item">
                      <a href="{{route('registrars')}}">{{ __('Registrars') }}</a>
                    </li>
                    <li class="breadcrumb-item active">
                      {{ __('Registrar Details') }}
                    </li>
                  </ol>
                </div>
                <h2 class="page-title">
                  {{ __('Registrar Details') }}
                </h2>
              </div>
              {% if isAdmin %}
              <!-- Page title actions -->
              <div class="col-auto ms-auto d-print-none">
                <div class="btn-list">
                  <a href="/registrar/history/{{ registrar.clid }}" class="btn btn-outline-purple d-none d-sm-inline-block">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 8l0 4l2 2" /><path d="M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5" /></svg>
                    {{ __('Registrar History') }}
                  </a>
                  <a href="/registrar/history/{{ registrar.clid }}" class="btn btn-outline-purple d-sm-none btn-icon" aria-label="{{ __('Registrar History') }}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 8l0 4l2 2" /><path d="M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5" /></svg>
                  </a>
                  <a href="/registrar/update/{{ registrar.clid }}" class="btn btn-primary d-none d-sm-inline-block">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" /><path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" /><path d="M16 5l3 3" /></svg>
                    {{ __('Update Registrar') }}
                  </a>
                  <a href="/registrar/update/{{ registrar.clid }}" class="btn btn-primary d-sm-none btn-icon" aria-label="{{ __('Update Registrar') }}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" /><path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" /><path d="M16 5l3 3" /></svg>
                  </a>
                </div>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
        <!-- Page body -->
        <div class="page-body">
          <div class="container-xl">
            <div class="col-12">
            {% include 'partials/flash.twig' %}
              <div class="card mb-3">
                <div class="card-header">
                  <h3 class="card-title">{{ __('Registrar') }} {{ registrar.name }}&nbsp;<span class="status status-green" title="Prefix">{{ registrar.prefix }}</span>&nbsp;<span class="status status-info" title="IANA ID">{{ registrar.iana_id|default('N/A') }}</span>&nbsp;<span class="status status-indigo" title="{{ __('Company Number') }}">{{ registrar.companyNumber|default('N/A') }}</span>&nbsp;<span class="status status-cyan" title="{{ __('VAT Number') }}">{{ registrar.vatNumber|default('N/A') }}</span></h3>
                  {% if roles != 0 %}
                  <div class="card-actions">
                    <a href="{{route('editRegistrar')}}" type="button" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" /><path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" /><path d="M16 5l3 3" /></svg>
                    {{ __('Update Registrar') }}
                    </a>
                  </div>
                  {% endif %}
                </div>
                <div class="card-body">
                  <div class="datagrid">
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Contact Email') }}</div>
                      <div class="datagrid-content">{{ registrar.email }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Website') }}</div>
                      <div class="datagrid-content">{{ registrar.url }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Abuse Phone') }}</div>
                      <div class="datagrid-content">{{ registrar.abuse_phone }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Abuse Email') }}</div>
                      <div class="datagrid-content">{{ registrar.abuse_email }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('WHOIS Server') }}</div>
                      <div class="datagrid-content">{{ registrar.whois_server }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('RDAP Server') }}</div>
                      <div class="datagrid-content">{{ registrar.rdap_server }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Creation Date') }}</div>
                      <div class="datagrid-content">{{ registrar.crdate }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Currency') }}</div>
                      <div class="datagrid-content">{{ registrar.currency }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Account Balance') }}</div>
                      <div class="datagrid-content">{{ registrar.currency }} {{ registrar.accountBalance }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Credit Limit') }}</div>
                      <div class="datagrid-content">{{ registrar.currency }} {{ registrar.creditLimit }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Credit Threshold') }}</div>
                      <div class="datagrid-content">{{ registrar.currency }} {{ registrar.creditThreshold }}</div>
                    </div>
                    <div class="datagrid-item">
                      <div class="datagrid-title">{{ __('Threshold Type') }}</div>
                      <div class="datagrid-content">{{ registrar.thresholdType|capitalize }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="card mb-3">
              <div class="card-body">
                <h5 class="card-title">{{ __('Registrar Contacts') }}</h5>
                <ul class="nav nav-tabs nav-fill" id="contactTabs" role="tablist">
                  <!-- Tab Headers -->
                  <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="owner-tab" data-bs-toggle="tab" data-bs-target="#owner" type="button" role="tab" aria-controls="owner" aria-selected="true">{{ __('Owner') }}</button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button class="nav-link" id="billing-tab" data-bs-toggle="tab" data-bs-target="#billing" type="button" role="tab" aria-controls="billing" aria-selected="false">{{ __('Billing') }}</button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tech-tab" data-bs-toggle="tab" data-bs-target="#tech" type="button" role="tab" aria-controls="tech" aria-selected="false">{{ __('Technical') }}</button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button class="nav-link" id="abuse-tab" data-bs-toggle="tab" data-bs-target="#abuse" type="button" role="tab" aria-controls="abuse" aria-selected="false">{{ __('Abuse') }}</button>
                  </li>
                </ul>

                <div class="tab-content" id="contactTabsContent">
                  <!-- Owner Tab -->
                  <div class="tab-pane fade show active" id="owner" role="tabpanel" aria-labelledby="owner-tab">
                    <div class="mt-3">
                      <div class="row">
                      {% for contact in contacts %}
                      {% if contact.type == 'owner' %}
                        <!-- First Column -->
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label for="ownerFirstName" class="form-label">{{ __('First Name') }}</label>
                            <div class="form-control-plaintext">{{ contact.first_name }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="ownerLastName" class="form-label">{{ __('Last Name') }}</label>
                            <div class="form-control-plaintext">{{ contact.last_name }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="ownerOrg" class="form-label">{{ __('Organization') }}</label>
                            <div class="form-control-plaintext">{{ contact.org }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="ownerStreet1" class="form-label">{{ __('Street Address') }}</label>
                            <div class="form-control-plaintext">{{ contact.street1 }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="ownerCity" class="form-label">{{ __('City') }}</label>
                            <div class="form-control-plaintext">{{ contact.city }}</div>
                          </div>
                        </div>

                        <!-- Second Column -->
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label for="ownerSp" class="form-label">{{ __('State/Province') }}</label>
                            <div class="form-control-plaintext">{{ contact.sp }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="ownerPc" class="form-label">{{ __('Postal Code') }}</label>
                            <div class="form-control-plaintext">{{ contact.pc }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="ownerCc" class="form-label">{{ __('Country') }}</label>
                            <div class="form-control-plaintext">{{ countries[contact.cc|upper] }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="ownerVoice" class="form-label">{{ __('Phone') }}</label>
                            <div class="form-control-plaintext">{{ contact.voice }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="ownerEmail" class="form-label">{{ __('Email') }}</label>
                            <div class="form-control-plaintext">{{ contact.email }}</div>
                          </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                      </div>
                    </div>
                  </div>

                  <!-- Billing Tab -->
                  <div class="tab-pane fade" id="billing" role="tabpanel" aria-labelledby="billing-tab">
                    <div class="mt-3">
                      <div class="row">
                      {% for contact in contacts %}
                      {% if contact.type == 'billing' %}
                        <!-- First Column -->
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label for="billingFirstName" class="form-label">{{ __('First Name') }}</label>
                            <div class="form-control-plaintext">{{ contact.first_name }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="billingLastName" class="form-label">{{ __('Last Name') }}</label>
                            <div class="form-control-plaintext">{{ contact.last_name }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="billingOrg" class="form-label">{{ __('Organization') }}</label>
                            <div class="form-control-plaintext">{{ contact.org }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="billingStreet1" class="form-label">{{ __('Street Address') }}</label>
                            <div class="form-control-plaintext">{{ contact.street1 }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="billingCity" class="form-label">{{ __('City') }}</label>
                            <div class="form-control-plaintext">{{ contact.city }}</div>
                          </div>
                        </div>

                        <!-- Second Column -->
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label for="billingSp" class="form-label">{{ __('State/Province') }}</label>
                            <div class="form-control-plaintext">{{ contact.sp }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="billingPc" class="form-label">{{ __('Postal Code') }}</label>
                            <div class="form-control-plaintext">{{ contact.pc }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="billingCc" class="form-label">{{ __('Country') }}</label>
                            <div class="form-control-plaintext">{{ countries[contact.cc|upper] }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="billingVoice" class="form-label">{{ __('Phone') }}</label>
                            <div class="form-control-plaintext">{{ contact.voice }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="billingEmail" class="form-label">{{ __('Email') }}</label>
                            <div class="form-control-plaintext">{{ contact.email }}</div>
                          </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                      
                  <!-- Tech Tab -->
                  <div class="tab-pane fade" id="tech" role="tabpanel" aria-labelledby="tech-tab">
                    <div class="mt-3">
                      <div class="row">
                      {% for contact in contacts %}
                      {% if contact.type == 'tech' %}
                        <!-- First Column -->
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label for="techFirstName" class="form-label">{{ __('First Name') }}</label>
                            <div class="form-control-plaintext">{{ contact.first_name }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="techLastName" class="form-label">{{ __('Last Name') }}</label>
                            <div class="form-control-plaintext">{{ contact.last_name }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="techOrg" class="form-label">{{ __('Organization') }}</label>
                            <div class="form-control-plaintext">{{ contact.org }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="techStreet1" class="form-label">{{ __('Street Address') }}</label>
                            <div class="form-control-plaintext">{{ contact.street1 }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="techCity" class="form-label">{{ __('City') }}</label>
                            <div class="form-control-plaintext">{{ contact.city }}</div>
                          </div>
                        </div>

                        <!-- Second Column -->
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label for="techSp" class="form-label">{{ __('State/Province') }}</label>
                            <div class="form-control-plaintext">{{ contact.sp }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="techPc" class="form-label">{{ __('Postal Code') }}</label>
                            <div class="form-control-plaintext">{{ contact.pc }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="techCc" class="form-label">{{ __('Country') }}</label>
                            <div class="form-control-plaintext">{{ countries[contact.cc|upper] }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="techVoice" class="form-label">{{ __('Phone') }}</label>
                            <div class="form-control-plaintext">{{ contact.voice }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="techEmail" class="form-label">{{ __('Email') }}</label>
                            <div class="form-control-plaintext">{{ contact.email }}</div>
                          </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                      </div>
                    </div>
                  </div>

                  <!-- Abuse Tab -->
                  <div class="tab-pane fade" id="abuse" role="tabpanel" aria-labelledby="abuse-tab">
                    <div class="mt-3">
                      <div class="row">
                      {% for contact in contacts %}
                      {% if contact.type == 'abuse' %}
                        <!-- First Column -->
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label for="abuseFirstName" class="form-label">{{ __('First Name') }}</label>
                            <div class="form-control-plaintext">{{ contact.first_name }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="abuseLastName" class="form-label">{{ __('Last Name') }}</label>
                            <div class="form-control-plaintext">{{ contact.last_name }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="abuseOrg" class="form-label">{{ __('Organization') }}</label>
                            <div class="form-control-plaintext">{{ contact.org }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="abuseStreet1" class="form-label">{{ __('Street Address') }}</label>
                            <div class="form-control-plaintext">{{ contact.street1 }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="abuseCity" class="form-label">{{ __('City') }}</label>
                            <div class="form-control-plaintext">{{ contact.city }}</div>
                          </div>
                        </div>

                        <!-- Second Column -->
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label for="abuseSp" class="form-label">{{ __('State/Province') }}</label>
                            <div class="form-control-plaintext">{{ contact.sp }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="abusePc" class="form-label">{{ __('Postal Code') }}</label>
                            <div class="form-control-plaintext">{{ contact.pc }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="abuseCc" class="form-label">{{ __('Country') }}</label>
                            <div class="form-control-plaintext">{{ countries[contact.cc|upper] }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="abuseVoice" class="form-label">{{ __('Phone') }}</label>
                            <div class="form-control-plaintext">{{ contact.voice }}</div>
                          </div>
                          <div class="mb-3">
                            <label for="abuseEmail" class="form-label">{{ __('Email') }}</label>
                            <div class="form-control-plaintext">{{ contact.email }}</div>
                          </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body">
                      <h5 class="card-title">{{ __('IP Whitelisting') }}</h5>
                      <ul class="list-group">
                        {% if registrarWhitelist is not empty %}
                            {% for ip in registrarWhitelist %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    {{ ip.addr }}
                                </li>
                            {% endfor %}
                        {% else %}
                            <li class="list-group-item">{{ __('No data available.') }}</li>
                        {% endif %}
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body">
                      <h5 class="card-title">{{ __('Registrar User') }}</h5>
                      <div class="datagrid">
                        <div class="datagrid-item">
                          <div class="datagrid-title">{{ __('EPP Username/CLID') }}</div>
                          <div class="datagrid-content">{{ registrar.clid }}</div>
                        </div>
                        <div class="datagrid-item">
                          <div class="datagrid-title">{{ __('Panel Login Email') }}</div>
                          <div class="datagrid-content">{{ userEmail.email }}</div>
                        </div>
                        {% if registrar.ssl_fingerprint is not empty %}
                          <div class="datagrid-item">
                            <div class="datagrid-title">{{ __('SSL Certificate Fingerprint') }}</div>
                            <div class="datagrid-content">{{ registrar.ssl_fingerprint }}</div>
                          </div>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card mb-3">
                <div class="card-body">
                  <h5 class="card-title">{{ __('Operational Test and Evaluation (OTE)') }}</h5>
                  <div class="row mb-3">
                    <div class="col-md-11">
                      <p class="card-text">
                        {{ __('Successfully passing the Operational Test and Evaluation (OTE) is a mandatory requirement for registrars. The OTE process evaluates the interaction and compliance of the registrar\'s system with registry operations through a series of EPP command tests in a controlled environment. Below you can find the results of these essential EPP command tests for your account:') }}
                      </p>
                    </div>
                    <div class="col-md-1 text-end">
                      <a href="{% if roles == 0 %}/registrar/check?reg={{ registrar.id }}{% else %}/registrar/check{% endif %}" title="Check Results" class="btn btn-icon btn-secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2" /><path d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M9 17v-4" /><path d="M12 17v-1" /><path d="M15 17v-2" /><path d="M12 17v-1" /></svg>
                      </a>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6">
                        <ul class="list-group">
                            {% for item in firstHalf %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    {{ item.command }}
                                    <span class="badge {% if item.result == 0 %}bg-green{% elseif item.result == 9 %}bg-orange{% elseif item.result == 1 %}bg-red{% endif %} text-white">
                                        {% if item.result == 0 %}{{ __('Completed') }}{% elseif item.result == 9 %}{{ __('Pending') }}{% elseif item.result == 1 %}{{ __('Failed') }}{% endif %}
                                    </span>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>

                    <div class="col-md-6">
                        <ul class="list-group">
                            {% for item in secondHalf %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    {{ item.command }}
                                    <span class="badge {% if item.result == 0 %}bg-green{% elseif item.result == 9 %}bg-orange{% elseif item.result == 1 %}bg-red{% endif %} text-white">
                                        {% if item.result == 0 %}{{ __('Completed') }}{% elseif item.result == 9 %}{{ __('Pending') }}{% elseif item.result == 1 %}{{ __('Failed') }}{% endif %}
                                    </span>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                  </div>
                </div>
              </div>
          </div>
        </div>
        {% include 'partials/footer.twig' %}
      </div>
{% endblock %}